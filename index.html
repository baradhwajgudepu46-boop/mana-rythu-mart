<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
  />
  <title>Mana Rythu Mart</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root{
      --brand:#4CAF50;
      --brand-2:#66bb6a;
      --text:#222;
      --muted:#555;
      --card:#fff;
      --bg:#f7f9f7;
      --danger:#f44336;
      --info:#2196F3;
      --warn:#ff9800;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased; overflow-x:hidden;
    }
    a{color:inherit; text-decoration:none}
    img{max-width:100%; display:block}
    button{font:inherit}
    .container{max-width:1100px; margin:0 auto; padding:16px; width:100%}
    header{
      position:sticky; top:0; z-index:10;
      background:#fff; border-bottom:3px solid var(--brand-2);
      display:flex; align-items:center; gap:12px; justify-content:space-between; flex-wrap:wrap;
      padding:10px 12px; box-shadow:0 4px 10px rgba(0,0,0,.05);
    }
    .logo{display:flex; align-items:center; gap:10px}
    .logo img{height:40px; width:auto; border-radius:8px}
    .logo .title{font-weight:800; color:var(--brand); letter-spacing:.6px; text-transform:uppercase}
    nav{display:flex; gap:10px; flex-wrap:wrap}
    nav a, nav button.link{
      padding:8px 10px; border-radius:10px; color:var(--muted); font-weight:600; border:none; background:transparent; cursor:pointer
    }
    nav a:hover, nav button.link:hover{background:rgba(76,175,80,.08); color:var(--brand)}
    .search{flex:1 1 260px; min-width:160px; display:flex}
    .search input{
      width:100%; padding:10px 14px; border:2px solid #e7e7e7; border-radius:999px;
      transition:border-color .2s, box-shadow .2s;
    }
    .search input:focus{outline:none; border-color:var(--brand); box-shadow:0 0 0 3px rgba(76,175,80,.12)}
    h2,h3{color:#2e7d32; border-bottom:2px solid #a5d6a7; padding-bottom:10px; margin:6px 0 16px}
    /* grid */
    .grid{display:grid; gap:14px}
    .products{grid-template-columns:repeat(auto-fill,minmax(210px,1fr))}
    .card{
      background:#fff; border-radius:14px; padding:12px; box-shadow:0 8px 20px rgba(0,0,0,.06);
      transition:transform .18s, box-shadow .18s;
    }
    .card:hover{transform:translateY(-3px); box-shadow:0 12px 24px rgba(0,0,0,.1)}
    .card img{height:150px; object-fit:contain; background:#fff; border-radius:10px}
    .name{margin:8px 0 4px; font-weight:700}
    .price{color:#ff5722; font-weight:800}
    .pill{padding:8px 12px; border-radius:999px; border:none; background:var(--brand); color:#fff; cursor:pointer}
    .pill.alt{background:#fff; border:1px solid #ddd; color:#333}
    .pill:disabled{opacity:.5; cursor:not-allowed}
    /* pages */
    .panel{background:#fff; border-radius:14px; padding:16px; box-shadow:0 8px 20px rgba(0,0,0,.06); margin:16px 0}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .field{width:100%; padding:10px 12px; border:1px solid #ddd; border-radius:10px}
    .label{font-weight:700; color:#333}
    /* cart */
    .cart-item{display:flex; justify-content:space-between; gap:10px; align-items:center; padding:10px 0; border-bottom:1px solid #eee; flex-wrap:wrap}
    .qty{display:flex; align-items:center; gap:8px}
    .qty button{width:36px; height:36px; border-radius:50%; border:1px solid #ddd; background:#fff; cursor:pointer}
    .total{font-size:1.1rem; font-weight:800}
    /* modal */
    .modal{display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:50; padding:20px}
    .modal .box{background:#fff; border-radius:12px; max-width:520px; margin:6% auto; padding:16px; box-shadow:0 10px 25px rgba(0,0,0,.25)}
    .modal .footer{display:flex; justify-content:flex-end; gap:10px; margin-top:12px}
    /* splash */
    #splash{position:fixed; inset:0; background:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:100; transition:opacity .35s, visibility .35s}
    #splash img{height:90px; margin-bottom:10px}
    #splash.hide{opacity:0; visibility:hidden; pointer-events:none}
    /* order chips */
    .chip{display:inline-block; padding:4px 10px; border-radius:999px; color:#fff; font-weight:700; font-size:.85rem}
    .s-pending{background:#ffc107}
    .s-pendingpay{background:#ff9800}
    .s-confirmed{background:#2196F3}
    .s-shipped{background:#9C27B0}
    .s-delivered{background:#4CAF50}
    .s-cancelled{background:#f44336}
    @media (max-width: 1024px){
      header{flex-direction:column; align-items:stretch}
      nav{justify-content:center}
      .search{width:100%}
    }
    @media (max-width: 768px){
      .card img{height:135px}
      /* admin table -> cards */
      table.resp{display:block; width:100%}
      table.resp thead{display:none}
      table.resp tr{display:block; margin-bottom:10px; background:#fff; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,.05); padding:8px}
      table.resp td{display:flex; justify-content:space-between; gap:8px; border:none}
      table.resp td::before{content:attr(data-k); font-weight:700; color:#444}
    }
    /* ---- ADDED FOR MOBILE -------- */
    @media (max-width: 600px) {
      .container{padding:8px;}
      header{flex-direction:column; gap:8px; padding:8px 6px;}
      .logo img{height:32px;}
      .logo .title{font-size:1.1rem;}
      nav{flex-direction:column; gap:4px; width:100%; align-items:flex-start;}
      .search{width:90%;}
      .search input{
        width:100%;
        padding: 8px 12px;
        font-size: 0.9rem;
      }
      .panel, .card{padding:8px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,.04);}
      .card img{height:100px; border-radius:6px;}
      .grid.products{grid-template-columns:1fr; gap:10px;}
      .cart-item, .row{flex-direction:column; gap:6px; align-items:flex-start;}
      .field, .pill, .pill.alt{font-size:1rem; padding:8px 10px;}
      .modal .box{width:95%; max-width:98vw; margin:10% auto; padding:6vw 4vw;}
      .modal .footer{flex-direction:column; gap:7px;}
    }
    button, .pill, .pill.alt{
      min-width:44px; min-height:44px; touch-action:manipulation;
    }
    /* Fix for logo on login page */
    .login-logo-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
  </style>
</head>
<body>
  <!-- Login Pane -->
  <section id="login-pane" class="container" style="margin-top:16px">
    <div class="panel" style="max-width:520px; margin-inline:auto">
      <div class="login-logo-container" style="margin-bottom:16px">
        <img src="https://lh3.googleusercontent.com/d/1qHvVgzqBnqMFZbs4LO3WxRso052F4LGx" alt="logo" style="height:90px; margin-bottom:10px">
        <div style="font-weight:800; color:var(--brand); font-size:22px">Mana Rythu Mart</div>
      </div>
      <h2>Login / Sign Up</h2>
      <form id="login-form">
        <input class="field" type="email" id="email" placeholder="Email" autocomplete="username" required>
        <div style="position:relative">
          <input class="field" style="padding-right:42px" type="password" id="password" placeholder="Password" autocomplete="current-password" required>
          <button type="button" id="toggle-pass" class="pill alt" style="position:absolute; right:6px; top:6px; height:32px">üëÅ</button>
        </div>
        <div class="row">
          <button type="submit" class="pill">Login</button>
          <button type="button" id="btn-signup" class="pill alt">Sign Up</button>
          <button type="button" id="btn-reset" class="pill alt">Reset Password</button>
        </div>
        <div id="auth-msg" style="margin-top:8px; color:var(--danger); font-weight:600"></div>
      </form>
      <div style="margin-top:10px; font-size:.9rem; color:#666">Tip: after creating your account, an admin can grant access by setting <code>isAdmin: true</code> on your user doc.</div>
    </div>
  </section>

  <div id="app-content" hidden>
    <header>
      <div class="logo">
        <img src="https://lh3.googleusercontent.com/d/1qHvVgzqBnqMFZbs4LO3WxRso052F4LGx" alt="logo">
        <div class="title">Mana Rythu Mart</div>
      </div>
      <div class="search"><input id="search" placeholder="Search products‚Ä¶"></div>
      <nav>
        <a href="#home" data-goto="home">Home</a>
        <a href="#cart" data-goto="cart">Cart (<span id="cart-count">0</span>)</a>
        <a href="#orders" data-goto="orders">Orders</a>
        <a href="#admin" id="admin-link" style="display:none" data-goto="admin">Admin</a>
        <button id="btn-auth" class="link">Login</button>
      </nav>
    </header>
    <main class="container">
      <!-- HOME -->
      <section id="page-home" class="panel">
        <h2>Our Products</h2>
        <div id="products" class="grid products">
          <div class="card">Loading‚Ä¶</div>
        </div>
      </section>

      <!-- CART -->
      <section id="page-cart" class="panel" hidden>
        <h2>Your Cart</h2>
        <div id="cart"></div>
        <div class="row" style="justify-content:space-between; margin-top:10px">
          <div class="total" id="cart-total">Total: ‚Çπ0.00</div>
        </div>
        <form id="checkout" class="panel" style="margin:14px 0 0">
          <h3>Checkout</h3>
          <input class="field" id="cust-name" placeholder="Full Name" required>
          <input class="field" id="cust-phone" placeholder="Phone Number" required>
          <textarea class="field" id="cust-address" placeholder="Shipping Address" required></textarea>
          <label class="label" for="pay">Payment Method</label>
          <select id="pay" class="field">
            <option value="cod">Cash on Delivery (COD)</option>
            <option value="upi">UPI (PhonePe/GPay)</option>
          </select>
          <button class="pill" type="submit">Place Order</button>
        </form>
      </section>

      <!-- ORDERS -->
      <section id="page-orders" class="panel" hidden>
        <h2>Your Orders</h2>
        <div id="orders"></div>
      </section>

      <!-- PAYMENT PAGE -->
      <section id="page-pay" class="panel" hidden style="text-align:center; max-width:560px; margin-inline:auto">
        <h2>Confirm Your Payment</h2>
        <p>Scan the QR code below to pay.</p>
        <div style="font-size:1.2rem; margin:8px 0">Amount: <b id="pay-amount">‚Çπ0.00</b></div>
        <img src="https://lh3.googleusercontent.com/d/17r48JjzNwt0UtjnOOpW5ByQQrNQzZD-5" alt="UPI QR" style="width:240px; margin:0 auto; border:1px solid #ddd; border-radius:8px">
        <div class="row" style="justify-content:center; margin-top:10px">
          <button id="btn-open-upi" class="pill">Open UPI App</button>
          <button id="btn-paid" class="pill" style="background:var(--info)">I have paid</button>
        </div>
        <div style="margin-top:8px; color:#666">UPI ID: <b id="upi-id">9491774950@ybl</b></div>
      </section>

      <!-- ADMIN -->
      <section id="page-admin" class="panel" hidden>
        <h2>Admin Dashboard</h2>
        <h3>Add / Edit Product</h3>
        <form id="prod-form" class="panel">
          <input type="hidden" id="prod-id">
          <input class="field" id="prod-name" placeholder="Product name" required>
          <textarea class="field" id="prod-desc" placeholder="Description"></textarea>
          <input class="field" id="prod-price" type="number" step="0.01" min="0" placeholder="Price (‚Çπ)" required>
          <input class="field" id="prod-img" placeholder="Image URL">
          <input class="field" id="prod-cat" placeholder="Category (fruits, vegetables‚Ä¶)">
          <div class="row">
            <button class="pill" type="submit" id="prod-submit">Add Product</button>
            <button class="pill alt" type="button" id="prod-reset">Reset</button>
            <button class="pill alt" type="button" id="seed" title="Add a few demo products">Seed Demo</button>
          </div>
        </form>
        <h3>Manage Orders</h3>
        <label class="label" for="order-filter">Filter</label>
        <select id="order-filter" class="field" style="max-width:260px">
          <option value="all">All</option>
          <option>Pending</option>
          <option>Pending Payment</option>
          <option>Pending Confirmation</option>
          <option>Confirmed</option>
          <option>Shipped</option>
          <option>Delivered</option>
          <option>Cancelled</option>
        </select>
        <table class="resp" style="width:100%; border-collapse:collapse; margin-top:10px">
          <thead>
            <tr style="background:#e8f5e9">
              <th style="text-align:left; padding:10px">Order ID</th>
              <th style="text-align:left; padding:10px">Customer</th>
              <th style="text-align:left; padding:10px">Total</th>
              <th style="text-align:left; padding:10px">Status</th>
              <th style="text-align:left; padding:10px">Date</th>
              <th style="text-align:left; padding:10px">Actions</th>
            </tr>
          </thead>
          <tbody id="admin-orders"></tbody>
        </table>
        <h3 style="margin-top:20px">Manage Products</h3>
        <div id="admin-prods"></div>
      </section>
    </main>
  </div>
  <!-- Generic Modal -->
  <div id="modal" class="modal">
    <div class="box">
      <h3 id="m-title" style="margin:0 0 8px"></h3>
      <div id="m-body"></div>
      <div class="footer" id="m-foot"></div>
    </div>
  </div
